import{_ as n,o as s,c as a,a as t}from"./app-CnbvU9a-.js";const p={},e=t(`<h1 id="paged-js-是如何工作的" tabindex="-1"><a class="header-anchor" href="#paged-js-是如何工作的" aria-hidden="true">#</a> paged.js 是如何工作的</h1><p>如果你曾经尝试过用 HTML 设计一个网站以供打印或出版一本图书，你就会体验到在屏幕上显示滚动文本的样式限制，Paged.js 可以帮助你在浏览器中生成分页的材料。</p><p><img src="https://pagedjs.org/images/flux-page.png" alt="img"></p><p>Paged.js 由三个模块组成，每个模块都有非常明确的任务：</p><ul><li>chunker 将内容分成独立的页面</li><li>polisher 将 CSS 声明转换为浏览器可以理解的格式；</li><li>previewer 会在浏览器中为你的图书创建预览。</li></ul><p>要开始使用 paged.js，你所要做的就是编写标准化的 CSS 声明并调用脚本。该库将通过将它们转换为浏览器原生支持的 CSS 样式或用 JavaScript 实现替换它们来解释这些声明。</p><h2 id="chunker-分割内容" tabindex="-1"><a class="header-anchor" href="#chunker-分割内容" aria-hidden="true">#</a> chunker 分割内容</h2><p>分块器(chunker)将所有已渲染的内容和应用于它的所有设计规则，将尽可能多的内容放在第一个盒子中，并寻找溢出的内容。</p><p>之后，脚本创建一个新的盒子，将尽可能多的溢出内容放入其中，寻找下一个溢出内容，如此反复，直到没有内容可以放入框中。Paged.js 会重复这个操作，直到完成。</p><p><img src="https://pagedjs.org/images/chuncker-2.png" alt="img"></p><p>为此，我们使用强大的 CSS columns 属性:每个页面都是一列。这样我们就可以方便地访问一些已经在浏览器中实现的属性，例如 column-breaks、element()或 widows 和 orphan。</p><p>PS.这并不妨碍你在内容中使用 CSS 的 column 属性</p><p>因为每个页面上的内容是固定的，所以当 HTML 或 CSS 发生变化时，你需要刷新页面来重复这个过程。</p><p>我们将看到，通过使用页面主布局改变页面之间的边距，可以控制分页和改变内容区域的大小。</p><h2 id="polisher-填充打印声明" tabindex="-1"><a class="header-anchor" href="#polisher-填充打印声明" aria-hidden="true">#</a> Polisher：填充打印声明</h2><p>Polisher 是 Paged.js 的一部分，它为每个页面翻译 CSS 规则。它构建新的盒子来创建页面布局，并将内容放置在这些页面中。我们使用 css-tree 这个库从文本中解析 CSS，并用类替换 @page 规则。Polisher 还用 DOM 变量替换了诸如运行标题、页面计数器或 CSS 生成的内容函数的调用。</p><p><img src="https://pagedjs.org/images/div-pages.png" alt="img"></p><p>让我们以下面的 CSS 为例：</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> 148mm 210mm<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 10mm<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 20mm<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 25mm<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 15mm<span class="token punctuation">;</span>

  <span class="token atrule"><span class="token rule">@bottom-left</span></span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token function">counter</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token atrule"><span class="token rule">@bottom-center</span></span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token function">string</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">text-transform</span><span class="token punctuation">:</span> uppercase<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token selector">h1#title</span> <span class="token punctuation">{</span>
  &lt;!-- <span class="token string">&quot;Moby Dick&quot;</span> --&gt;
  <span class="token property">string-set</span><span class="token punctuation">:</span> title <span class="token function">content</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Paged.js 将这些转换为浏览器可以理解的 CSS：</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">.pagedjs_page</span> <span class="token punctuation">{</span>
  <span class="token property">--pagedjs-string-title</span><span class="token punctuation">:</span> <span class="token string">&#39;Moby Dick&#39;</span><span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 10mm<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 20mm<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 25mm<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 15mm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.pagedjs_page .pagedjs_margin-bottom-left::after</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token function">string</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.pagedjs_page .pagedjs_margin-bottom-center::after</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--pagedjs-string-title<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">text-transform</span><span class="token punctuation">:</span> uppercase<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这将应用于转换后的 DOM(这是 Paged.js 生成的简化版本)：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagedjs_page<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagedjs_pagebox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagedjs_margin pagedjs_margin-bottom-left hasContent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagedjs_margin-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- ::after --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagedjs_margin pagedjs_margin-bottom-center hasContent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagedjs_margin-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- ::after --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagedjs_area<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- content of the page --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在本文档中，我们将指定我们实现的 CSS 属性和我们使用的属性，以便浏览器能够解释它们。</p><h2 id="previewer-渲染分页的文档" tabindex="-1"><a class="header-anchor" href="#previewer-渲染分页的文档" aria-hidden="true">#</a> Previewer: 渲染分页的文档</h2><p>Paged.js 的预览器加载模块，使用 polisher 和 chunker 布局内容，在浏览器中构建文档的预览，这样你就能准确地看到内容的外观，然后相应地调整内容。</p><p>在幕后，Paged.js 通过添加一些 HTML 元素来修改 DOM 结构，构建并渲染你的布局。这些修改是在渲染期间进行的，原始的 HTML 文档没有修改。</p><p>它还为每个节点添加了引用(例如，它添加了类来区分右边或左边页面)，这使我们能够完全控制页面布局，而不需要任何 hack。</p><p>这个文档将为每个 CSS 属性指定构建和渲染书籍所需的 DOM 修改，如果你想进一步使用 Paged.js 并添加自己的函数，你也可以在 Javascript 中直接使用这些元素的类来访问它们。</p>`,29),c=[e];function o(l,i){return s(),a("div",null,c)}const r=n(p,[["render",o],["__file","how-pagedjs-works.html.vue"]]);export{r as default};
